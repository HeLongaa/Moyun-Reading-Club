"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[89],{6089:(e,t,a)=>{a.r(t),a.d(t,{default:()=>w});var l=a(641),n=a(33),r=a(3751);const o={class:"comment-detail"},i={key:0,class:"loading"},s={key:1,class:"error"},c={key:2},m={class:"comment-meta"},u={class:"author"},d={class:"time"},p={class:"comment-content"},h={class:"comment-actions"},k=["disabled"],y={key:0,class:"reply-box"},C=["disabled"],v={key:1,class:"replies"},g={class:"reply-author"},b={class:"reply-content"},$={class:"reply-time"};function f(e,t,a,f,A,L){return(0,l.uX)(),(0,l.CE)("div",o,[t[5]||(t[5]=(0,l.Lk)("h2",null,"评论详情",-1)),A.loading?((0,l.uX)(),(0,l.CE)("div",i,"加载中...")):A.error?((0,l.uX)(),(0,l.CE)("div",s,(0,n.v_)(A.error),1)):((0,l.uX)(),(0,l.CE)("div",c,[(0,l.Lk)("div",m,[(0,l.Lk)("span",u,(0,n.v_)(A.comment.author?.account||A.comment.author_id),1),(0,l.Lk)("span",d,(0,n.v_)(A.comment.publish_time?.slice(0,16)),1)]),(0,l.Lk)("div",p,[(0,l.Lk)("p",null,(0,n.v_)(A.comment.content),1)]),(0,l.Lk)("div",h,[(0,l.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>L.likeComment&&L.likeComment(...e)),disabled:A.liked},"👍 "+(0,n.v_)(A.comment.likeCount||0)+" 赞",9,k),(0,l.Lk)("button",{onClick:t[1]||(t[1]=e=>A.replying=!A.replying)},"回复")]),A.replying?((0,l.uX)(),(0,l.CE)("div",y,[(0,l.bo)((0,l.Lk)("textarea",{"onUpdate:modelValue":t[2]||(t[2]=e=>A.replyText=e),placeholder:"写下你的回复...",rows:"3"},null,512),[[r.Jo,A.replyText]]),(0,l.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>L.submitReply&&L.submitReply(...e)),disabled:!A.replyText.trim()},"提交",8,C)])):(0,l.Q3)("",!0),A.replies.length?((0,l.uX)(),(0,l.CE)("div",v,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(A.replies,(e=>((0,l.uX)(),(0,l.CE)("div",{class:"reply",key:e.id},[(0,l.Lk)("span",g,(0,n.v_)(e.author?.account||e.author_id),1),t[4]||(t[4]=(0,l.eW)("： ")),(0,l.Lk)("span",b,(0,n.v_)(e.content),1),(0,l.Lk)("span",$,(0,n.v_)(e.publish_time?.slice(0,16)),1)])))),128))])):(0,l.Q3)("",!0)]))])}var A=a(3814);const L={getJournalComments:(e,t)=>A.A.get(`/journal/${e}/comments`,{params:t}),addJournalComment:(e,t)=>A.A.post(`/journal/${e}/comments`,t),deleteJournalComment:(e,t)=>A.A.delete(`/journal/${e}/comments/${t}`),likeJournal:e=>A.A.post(`/journal/${e}/like`),getJournals:e=>A.A.get("/journal",{params:e}),getJournal:e=>A.A.get(`/journal/${e}`),createJournal:e=>A.A.post("/journal",e),updateJournal:(e,t)=>A.A.put(`/journal/${e}`,t),deleteJournal:e=>A.A.delete(`/journal/${e}`),uploadJournalHeader:(e,t)=>{const a=new FormData;return a.append("header",t),A.A.post(`/journal/upload-header/${e}`,a,{headers:{"Content-Type":"multipart/form-data"}})},getCommentDetail:e=>A.A.get(`/comment/${e}`),interact:(e,t)=>A.A.post(`/comment/${e}/interact`,{action:t}),replyComment:(e,t)=>A.A.post(`/comment/${e}/reply`,t)},_={name:"CommentDetail",data(){return{loading:!0,liked:!1,replying:!1,replyText:"",comment:{},replies:[],error:""}},async created(){await this.fetchDetail()},methods:{async fetchDetail(){this.loading=!0,this.error="";try{const e=this.$route.params.id,t=await L.getCommentDetail(e);this.comment=t.data.data||{},this.replies=this.comment.replies||[]}catch(e){this.error="加载失败，请稍后重试"}finally{this.loading=!1}},async likeComment(){if(!this.liked)try{await L.interact(this.$route.params.id,"like"),this.liked=!0,await this.fetchDetail()}catch(e){this.error="点赞失败，请稍后重试"}},async submitReply(){if(this.replyText.trim())try{await L.replyComment(this.$route.params.id,{content:this.replyText}),this.replyText="",this.replying=!1,await this.fetchDetail()}catch(e){this.error="回复失败，请稍后重试"}}}};var J=a(6262);const j=(0,J.A)(_,[["render",f],["__scopeId","data-v-bc817b2c"]]),w=j}}]);
//# sourceMappingURL=89.d4993f13.js.map