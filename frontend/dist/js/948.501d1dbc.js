"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[948],{7948:(e,t,a)=>{a.r(t),a.d(t,{default:()=>f});var n=a(641),o=a(33),s=a(3751);const i={class:"recommendations"},r={class:"filter-bar"},l=["value"],d={class:"rating-filter"},c={class:"book-list"},u={key:0,class:"loading"},g={class:"pagination"},k=["disabled"],m=["disabled"];function h(e,t,a,h,p,P){const b=(0,n.g2)("BookCard");return(0,n.uX)(),(0,n.CE)("div",i,[t[6]||(t[6]=(0,n.Lk)("h2",null,"为您推荐",-1)),(0,n.Lk)("div",r,[(0,n.bo)((0,n.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>p.filters.category=e)},[t[4]||(t[4]=(0,n.Lk)("option",{value:""},"所有分类",-1)),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(P.categories,(e=>((0,n.uX)(),(0,n.CE)("option",{key:e,value:e},(0,o.v_)(e),9,l)))),128))],512),[[s.u1,p.filters.category]]),(0,n.Lk)("div",d,[t[5]||(t[5]=(0,n.Lk)("label",null,"最低评分：",-1)),(0,n.bo)((0,n.Lk)("input",{type:"range",min:"0",max:"5","onUpdate:modelValue":t[1]||(t[1]=e=>p.filters.minRating=e)},null,512),[[s.Jo,p.filters.minRating]]),(0,n.eW)(" "+(0,o.v_)(p.filters.minRating),1)])]),(0,n.Lk)("div",c,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(P.recommendations,(e=>((0,n.uX)(),(0,n.Wv)(b,{key:e.id,book:e},null,8,["book"])))),128)),p.loading?((0,n.uX)(),(0,n.CE)("div",u," 加载中... ")):(0,n.Q3)("",!0)]),(0,n.Lk)("div",g,[(0,n.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>P.prevPage&&P.prevPage(...e)),disabled:1===p.currentPage}," 上一页 ",8,k),(0,n.Lk)("span",null,"第 "+(0,o.v_)(p.currentPage)+" 页",1),(0,n.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>P.nextPage&&P.nextPage(...e)),disabled:p.currentPage===p.totalPages}," 下一页 ",8,m)])])}const p={data(){return{currentPage:1,totalPages:1,filters:{category:"",minRating:0},loading:!1}},computed:{recommendations(){return this.$store.getters["books/recommendedBooks"]},categories(){return this.$store.state.books.categories}},methods:{async loadRecommendations(){this.loading=!0;try{await this.$store.dispatch("books/fetchRecommendedBooks",{page:this.currentPage,...this.filters})}finally{this.loading=!1}},nextPage(){this.currentPage<this.totalPages&&(this.currentPage++,this.loadRecommendations())},prevPage(){this.currentPage>1&&(this.currentPage--,this.loadRecommendations())}},watch:{filters:{deep:!0,handler(){this.currentPage=1,this.loadRecommendations()}}},created(){this.loadRecommendations()}};var P=a(6262);const b=(0,P.A)(p,[["render",h]]),f=b}}]);
//# sourceMappingURL=948.501d1dbc.js.map