{"version":3,"file":"js/956.35602c2e.js","mappings":"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","sources":["webpack://frontend/./src/views/Circle/Settings.vue","webpack://frontend/./src/components/circles/MemberList.vue","webpack://frontend/./src/components/circles/MemberList.vue?710b","webpack://frontend/./src/views/Circle/Settings.vue?8847"],"sourcesContent":["<template>\r\n  <div class=\"circle-settings\">\r\n    <h2>学习圈设置</h2>\r\n    \r\n    <el-form \r\n      :model=\"form\" \r\n      label-width=\"120px\"\r\n      @submit.native.prevent=\"handleSubmit\"\r\n    >\r\n      <el-form-item label=\"圈子名称\">\r\n        <el-input v-model=\"form.name\" />\r\n      </el-form-item>\r\n      \r\n      <el-form-item label=\"圈子描述\">\r\n        <el-input \r\n          v-model=\"form.description\" \r\n          type=\"textarea\" \r\n          :rows=\"3\" \r\n        />\r\n      </el-form-item>\r\n      \r\n      <el-form-item>\r\n        <el-button \r\n          type=\"primary\" \r\n          native-type=\"submit\"\r\n          :loading=\"loading\"\r\n        >\r\n          保存设置\r\n        </el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n    \r\n    <h3>成员管理</h3>\r\n    <member-list \r\n      :members=\"members\" \r\n      @update-role=\"handleUpdateRole\"\r\n    />\r\n    \r\n    <el-divider />\r\n    \r\n    <el-popconfirm\r\n      title=\"确定要删除这个圈子吗？\"\r\n      @confirm=\"handleDeleteCircle\"\r\n    >\r\n      <el-button \r\n        slot=\"reference\" \r\n        type=\"danger\" \r\n        :loading=\"deleting\"\r\n      >\r\n        删除圈子\r\n      </el-button>\r\n    </el-popconfirm>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapState, mapActions } from 'vuex'\r\nimport MemberList from '@/components/circles/MemberList'\r\n\r\nexport default {\r\n  name: 'CircleSettings',\r\n  components: { MemberList },\r\n  \r\n  data() {\r\n    return {\r\n      loading: false,\r\n      deleting: false,\r\n      form: {\r\n        name: '',\r\n        description: ''\r\n      },\r\n      members: []\r\n    }\r\n  },\r\n  \r\n  computed: {\r\n    ...mapState('circles', ['currentCircle'])\r\n  },\r\n  \r\n  watch: {\r\n    currentCircle: {\r\n      immediate: true,\r\n      handler(circle) {\r\n        if (circle) {\r\n          this.form = {\r\n            name: circle.name,\r\n            description: circle.description\r\n          }\r\n          this.fetchMembers()\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \r\n  methods: {\r\n    ...mapActions('circles', [\r\n      'updateCircle',\r\n      'fetchCircleMembers',\r\n      'updateMemberRole',\r\n      'deleteCircle'\r\n    ]),\r\n    \r\n    async fetchMembers() {\r\n      const members = await this.fetchCircleMembers(this.currentCircle.id)\r\n      this.members = members\r\n    },\r\n    \r\n    async handleSubmit() {\r\n      this.loading = true\r\n      try {\r\n        await this.updateCircle({\r\n          circleId: this.currentCircle.id,\r\n          data: this.form\r\n        })\r\n        this.$message.success('设置已保存')\r\n      } finally {\r\n        this.loading = false\r\n      }\r\n    },\r\n    \r\n    async handleUpdateRole({ userId, role }) {\r\n      await this.updateMemberRole({\r\n        circleId: this.currentCircle.id,\r\n        userId,\r\n        role\r\n      })\r\n      this.$message.success('成员权限已更新')\r\n    },\r\n    \r\n    async handleDeleteCircle() {\r\n      this.deleting = true\r\n      try {\r\n        await this.deleteCircle(this.currentCircle.id)\r\n        this.$message.success('圈子已删除')\r\n        this.$router.push('/circles')\r\n      } finally {\r\n        this.deleting = false\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.circle-settings {\r\n  max-width: 800px;\r\n  margin: 0 auto;\r\n  padding: 20px;\r\n}\r\n</style>","<template>\r\n  <div>\r\n    <el-table :data=\"members\" style=\"width: 100%\">\r\n      <el-table-column prop=\"username\" label=\"成员\" />\r\n      <el-table-column prop=\"role\" label=\"角色\">\r\n        <template #default=\"{ row }\">\r\n          <el-select\r\n            v-model=\"row.role\"\r\n            @change=\"(role) => handleRoleChange(row.id, role)\"\r\n          >\r\n            <el-option label=\"普通成员\" value=\"member\" />\r\n            <el-option label=\"管理员\" value=\"admin\" />\r\n            <el-option label=\"创建者\" value=\"creator\" />\r\n          </el-select>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column v-if=\"isOwner\" label=\"操作\">\r\n        <template #default=\"{ row }\">\r\n          <el-button\r\n            v-if=\"row.state === 'pending'\"\r\n            size=\"mini\"\r\n            type=\"success\"\r\n            @click=\"audit(row.id, true)\"\r\n          >\r\n            通过\r\n          </el-button>\r\n          <el-button\r\n            v-if=\"row.state === 'pending'\"\r\n            size=\"mini\"\r\n            type=\"danger\"\r\n            @click=\"audit(row.id, false)\"\r\n          >\r\n            拒绝\r\n          </el-button>\r\n          <el-button\r\n            v-if=\"row.state !== 'pending' && row.role !== 'creator'\"\r\n            size=\"mini\"\r\n            type=\"danger\"\r\n            @click=\"remove(row.id)\"\r\n          >\r\n            移除\r\n          </el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'MemberList',\r\n  props: {\r\n    members: {\r\n      type: Array,\r\n      required: true\r\n    },\r\n    isOwner: {\r\n      type: Boolean,\r\n      default: false\r\n    }\r\n  },\r\n  methods: {\r\n    handleRoleChange(userId, role) {\r\n      this.$emit('update-role', { userId, role })\r\n    },\r\n    audit(userId, isOno) {\r\n      this.$emit('audit', { userId, isOno })\r\n    },\r\n    remove(userId) {\r\n      this.$emit('remove', userId)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.el-select {\r\n  width: 120px;\r\n}\r\n.el-table {\r\n  margin-bottom: 1rem;\r\n}\r\n</style>","import { render } from \"./MemberList.vue?vue&type=template&id=d8306b64&scoped=true\"\nimport script from \"./MemberList.vue?vue&type=script&lang=js\"\nexport * from \"./MemberList.vue?vue&type=script&lang=js\"\n\nimport \"./MemberList.vue?vue&type=style&index=0&id=d8306b64&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-d8306b64\"]])\n\nexport default __exports__","import { render } from \"./Settings.vue?vue&type=template&id=ce2033ea&scoped=true\"\nimport script from \"./Settings.vue?vue&type=script&lang=js\"\nexport * from \"./Settings.vue?vue&type=script&lang=js\"\n\nimport \"./Settings.vue?vue&type=style&index=0&id=ce2033ea&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-ce2033ea\"]])\n\nexport default __exports__"],"names":["class","model","form","handleSubmit","label","name","description","type","rows","loading","members","handleUpdateRole","title","handleDeleteCircle","slot","deleting","data","style","prop","default","row","role","handleRoleChange","id","value","state","size","audit","remove","props","Array","required","isOwner","Boolean","methods","userId","this","$emit","isOno","__exports__","components","MemberList","computed","watch","currentCircle","immediate","handler","circle","fetchMembers","fetchCircleMembers","updateCircle","circleId","$message","success","updateMemberRole","deleteCircle","$router","push","render"],"sourceRoot":""}